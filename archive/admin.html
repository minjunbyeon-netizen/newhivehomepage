<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Archive Admin - Demo Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Space Mono', 'Courier New', monospace;
            background: #1a1a1a;
            color: #f5f5f0;
            min-height: 100vh;
            padding: 40px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #FFD93D;
        }

        .subtitle {
            color: #888;
            margin-bottom: 40px;
        }

        .section {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 24px;
        }

        .section h2 {
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #FFD93D;
            margin-bottom: 16px;
        }

        .trend-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .trend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: #333;
            border-radius: 4px;
        }

        .trend-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
        }

        .trend-item .keyword {
            flex: 1;
        }

        .trend-item .category {
            color: #888;
            font-size: 12px;
        }

        .btn {
            display: inline-block;
            padding: 14px 28px;
            background: #FFD93D;
            color: #1a1a1a;
            font-family: inherit;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .btn:hover {
            background: #FFF176;
            transform: translateY(-2px);
        }

        .btn:disabled {
            background: #555;
            color: #888;
            cursor: not-allowed;
            transform: none;
        }

        .btn-danger {
            background: #ff6b6b;
        }

        .btn-danger:hover {
            background: #ff8787;
        }

        .log {
            background: #111;
            border-radius: 4px;
            padding: 16px;
            font-size: 12px;
            line-height: 1.8;
            max-height: 300px;
            overflow-y: auto;
            white-space: pre-wrap;
        }

        .log .success {
            color: #4ADE80;
        }

        .log .error {
            color: #ff6b6b;
        }

        .log .info {
            color: #60A5FA;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 16px;
            margin-bottom: 24px;
        }

        .stat-card {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 36px;
            font-weight: 700;
            color: #FFD93D;
        }

        .stat-card .label {
            font-size: 11px;
            text-transform: uppercase;
            color: #888;
            margin-top: 8px;
        }

        .actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .link-box {
            margin-top: 24px;
            padding: 16px;
            background: #333;
            border-radius: 4px;
        }

        .link-box a {
            color: #60A5FA;
            text-decoration: none;
        }

        .link-box a:hover {
            text-decoration: underline;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ğŸ Archive Admin</h1>
        <p class="subtitle">Demo Article Generator - Firebase ì—°ë™ í…ŒìŠ¤íŠ¸</p>

        <!-- í†µê³„ -->
        <div class="stats">
            <div class="stat-card">
                <div class="number" id="totalArticles">-</div>
                <div class="label">Total Articles</div>
            </div>
            <div class="stat-card">
                <div class="number" id="totalCategories">-</div>
                <div class="label">Categories</div>
            </div>
            <div class="stat-card">
                <div class="number" id="autoGenerated">-</div>
                <div class="label">Auto Generated</div>
            </div>
        </div>

        <!-- íŠ¸ë Œë“œ í‚¤ì›Œë“œ ì„ íƒ -->
        <div class="section">
            <h2>ğŸ”¥ ë°ëª¨ íŠ¸ë Œë“œ í‚¤ì›Œë“œ</h2>
            <div class="trend-list" id="trendList">
                <!-- JSë¡œ ë Œë”ë§ -->
            </div>
        </div>

        <!-- ì•¡ì…˜ ë²„íŠ¼ -->
        <div class="section">
            <h2>âš¡ Actions</h2>
            <div class="actions">
                <button class="btn" id="btnGenerate" onclick="generateArticles()">
                    ì„ íƒí•œ í‚¤ì›Œë“œë¡œ ê¸€ ìƒì„±
                </button>
                <button class="btn" id="btnGenerateAll" onclick="generateAllArticles()">
                    ì „ì²´ ìƒì„± (5ê°œ)
                </button>
                <button class="btn btn-danger" id="btnClear" onclick="clearAllArticles()">
                    ì „ì²´ ì‚­ì œ
                </button>
            </div>
        </div>

        <!-- ë¡œê·¸ -->
        <div class="section">
            <h2>ğŸ“‹ Log</h2>
            <div class="log" id="logBox">[ì‹œìŠ¤í…œ] ì¤€ë¹„ ì™„ë£Œ. ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ ì‹œì‘í•˜ì„¸ìš”.</div>
        </div>

        <!-- ë§í¬ -->
        <div class="link-box">
            <strong>ğŸ‘‰ Archive í˜ì´ì§€:</strong>
            <a href="./archive.php" target="_blank">archive.php ì—´ê¸°</a>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, getDocs, addDoc, deleteDoc, doc, query, orderBy, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        // Firebase ì„¤ì •
        const firebaseConfig = {
            apiKey: "AIzaSyBeZGgTw8zJoYz26PUfk3xoU-83oMD3v_M",
            authDomain: "hivemedia-archive.firebaseapp.com",
            projectId: "hivemedia-archive",
            storageBucket: "hivemedia-archive.firebasestorage.app",
            messagingSenderId: "105246116532",
            appId: "1:105246116532:web:18aad82490a11b7d4ea5e1"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // ì „ì—­ ë³€ìˆ˜
        window.db = db;
        window.collection = collection;
        window.getDocs = getDocs;
        window.addDoc = addDoc;
        window.deleteDoc = deleteDoc;
        window.doc = doc;
        window.query = query;
        window.orderBy = orderBy;
        window.serverTimestamp = serverTimestamp;

        // ë°ëª¨ íŠ¸ë Œë“œ ë°ì´í„°
        const DEMO_TRENDS = [
            { keyword: "2026ë…„ ë§ˆì¼€íŒ… íŠ¸ë Œë“œ", category: "íŠ¸ë Œë“œ" },
            { keyword: "AI ê´‘ê³  ìë™í™”", category: "ê¸°ìˆ " },
            { keyword: "ë¶€ì‚° ê´€ê´‘ ë§ˆì¼€íŒ…", category: "ì§€ì—­" },
            { keyword: "SNS ìˆí¼ ì½˜í…ì¸ ", category: "SNS" },
            { keyword: "ë¸Œëœë“œ ìŠ¤í† ë¦¬í…”ë§", category: "ë¸Œëœë”©" }
        ];
        window.DEMO_TRENDS = DEMO_TRENDS;

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            renderTrendList();
            loadStats();
        });

        // íŠ¸ë Œë“œ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§
        function renderTrendList() {
            const container = document.getElementById('trendList');
            container.innerHTML = DEMO_TRENDS.map((t, i) => `
                <div class="trend-item">
                    <input type="checkbox" id="trend${i}" value="${i}" checked>
                    <span class="keyword">${t.keyword}</span>
                    <span class="category">[${t.category}]</span>
                </div>
            `).join('');
        }

        // í†µê³„ ë¡œë“œ
        window.loadStats = async function () {
            try {
                const articlesRef = collection(db, 'articles');
                const snapshot = await getDocs(articlesRef);

                const articles = [];
                snapshot.forEach(doc => articles.push(doc.data()));

                document.getElementById('totalArticles').textContent = articles.length;

                const categories = [...new Set(articles.map(a => a.category).filter(Boolean))];
                document.getElementById('totalCategories').textContent = categories.length;

                const autoGen = articles.filter(a => a.source === 'auto_generated').length;
                document.getElementById('autoGenerated').textContent = autoGen;
            } catch (e) {
                console.error('Stats load error:', e);
            }
        };

        // ë¡œê·¸ ì¶”ê°€
        window.log = function (message, type = 'info') {
            const logBox = document.getElementById('logBox');
            const time = new Date().toLocaleTimeString('ko-KR');
            logBox.innerHTML += `\n<span class="${type}">[${time}] ${message}</span>`;
            logBox.scrollTop = logBox.scrollHeight;
        };

        // ê¸€ ìƒì„± (ë°ëª¨ ì½˜í…ì¸ )
        window.generateDemoContent = function (keyword, category) {
            return {
                title: `[${category}] ${keyword}`,
                summary: `${keyword}ì— ëŒ€í•œ í•˜ì´ë¸Œë¯¸ë””ì–´ì˜ ì¸ì‚¬ì´íŠ¸ì…ë‹ˆë‹¤.`,
                content: `## ${keyword}\n\në§ˆì¼€íŒ… ì—…ê³„ì—ì„œ '${keyword}'ê°€ ì£¼ëª©ë°›ê³  ìˆìŠµë‹ˆë‹¤.\n\n### í•µì‹¬ í¬ì¸íŠ¸\n\n1. **íŠ¸ë Œë“œ ë¶„ì„**: ìµœê·¼ ê²€ìƒ‰ëŸ‰ì´ ê¸‰ì¦í•˜ê³  ìˆëŠ” í‚¤ì›Œë“œì…ë‹ˆë‹¤.\n2. **ì‹¤ë¬´ ì ìš©**: í•˜ì´ë¸Œë¯¸ë””ì–´ëŠ” ì´ íŠ¸ë Œë“œë¥¼ í™œìš©í•œ ë‹¤ì–‘í•œ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ê³  ìˆìŠµë‹ˆë‹¤.\n3. **í–¥í›„ ì „ë§**: ì•ìœ¼ë¡œë„ ì§€ì†ì ì¸ ì„±ì¥ì´ ì˜ˆìƒë©ë‹ˆë‹¤.\n\n### í•˜ì´ë¸Œë¯¸ë””ì–´ì˜ ì œì•ˆ\n\në¶€ì‚° ì§€ì—­ ê´‘ê³  ì „ë¬¸ ê¸°ì—…ìœ¼ë¡œì„œ, ì €í¬ëŠ” ì´ íŠ¸ë Œë“œë¥¼ ì§€ì—­ íŠ¹ì„±ì— ë§ê²Œ ì ìš©í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ìµœì ì˜ ë§ˆì¼€íŒ… ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.`,
                category: category,
                trendKeyword: keyword,
                source: 'auto_generated',
                createdAt: serverTimestamp()
            };
        };

        // ì„ íƒëœ í‚¤ì›Œë“œë¡œ ê¸€ ìƒì„±
        window.generateArticles = async function () {
            const checkboxes = document.querySelectorAll('#trendList input:checked');
            if (checkboxes.length === 0) {
                log('ì„ íƒëœ í‚¤ì›Œë“œê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
                return;
            }

            const btn = document.getElementById('btnGenerate');
            btn.disabled = true;

            log(`ğŸš€ ${checkboxes.length}ê°œ ê¸€ ìƒì„± ì‹œì‘...`, 'info');

            for (const cb of checkboxes) {
                const trend = DEMO_TRENDS[parseInt(cb.value)];
                try {
                    const article = generateDemoContent(trend.keyword, trend.category);
                    await addDoc(collection(db, 'articles'), article);
                    log(`âœ… ìƒì„± ì™„ë£Œ: ${article.title}`, 'success');
                } catch (e) {
                    log(`âŒ ìƒì„± ì‹¤íŒ¨: ${trend.keyword} - ${e.message}`, 'error');
                }
            }

            log('ğŸ‰ ìƒì„± ì™„ë£Œ!', 'success');
            btn.disabled = false;
            loadStats();
        };

        // ì „ì²´ ìƒì„±
        window.generateAllArticles = async function () {
            document.querySelectorAll('#trendList input').forEach(cb => cb.checked = true);
            await generateArticles();
        };

        // ì „ì²´ ì‚­ì œ
        window.clearAllArticles = async function () {
            if (!confirm('ì •ë§ ëª¨ë“  ê¸€ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const btn = document.getElementById('btnClear');
            btn.disabled = true;

            log('ğŸ—‘ï¸ ì „ì²´ ì‚­ì œ ì‹œì‘...', 'info');

            try {
                const articlesRef = collection(db, 'articles');
                const snapshot = await getDocs(articlesRef);

                let count = 0;
                for (const docSnap of snapshot.docs) {
                    await deleteDoc(doc(db, 'articles', docSnap.id));
                    count++;
                }

                log(`âœ… ${count}ê°œ ê¸€ ì‚­ì œ ì™„ë£Œ`, 'success');
            } catch (e) {
                log(`âŒ ì‚­ì œ ì‹¤íŒ¨: ${e.message}`, 'error');
            }

            btn.disabled = false;
            loadStats();
        };
    </script>
</body>

</html>